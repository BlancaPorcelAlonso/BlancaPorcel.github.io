<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Demo Java ‚Äî CheerpJ</title>
    <style>
      body {
        margin: 0;
        font-family: system-ui, Arial;
        background: #0b0f19;
        color: #e6e9f0;
        display: grid;
        place-items: center;
        min-height: 100vh;
      }
      .wrap {
        width: min(960px, 100%);
        background: #141a2a;
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 14px;
        padding: 16px;
      }
      header {
        display: flex;
        gap: 16px;
        justify-content: flex-end;
        margin-bottom: 8px;
      }
      a {
        color: #a5b4fc;
        text-decoration: none;
      }
      button {
        padding: 8px 12px;
        border-radius: 10px;
        background: #1e2638;
        color: #fff;
        border: 1px solid rgba(255, 255, 255, 0.12);
        cursor: pointer;
      }
      #status {
        font-size: 14px;
        color: #9aa3b2;
        margin-top: 8px;
        white-space: pre-wrap;
      }
    </style>
  </head>

  <body>
    <div class="wrap">
      <header>
        <a href="index.html">‚üµ Volver</a>
        <a
          href="https://blancaporcelalonso.github.io/BlancaPorcel.github.io/apps/Ajedrez.jar"
          download
          >Descargar JAR</a
        >
        <button id="run">Iniciar demo</button>
      </header>
      <div id="status">Preparando‚Ä¶</div>
    </div>

    <!-- Carga del runtime de CheerpJ -->
    <script src="https://cjrtnc.leaningtech.com/latest/loader.js"></script>

    <!-- üí° El script va al final del <body>, cuando el DOM ya existe -->
    <script>
      // Aqu√≠ el DOM YA EXISTE
      const statusEl = document.getElementById("status");
      const runBtn = document.getElementById("run");
      const log = (m) => {
        if (statusEl) statusEl.textContent = m;
        console.log("[DEMO]", m);
      };

      const JAR_URL =
        "https://blancaporcelalonso.github.io/BlancaPorcel.github.io/apps/Ajedrez.jar";

      async function run() {
        try {
          log("Inicializando CheerpJ‚Ä¶");
          await cheerpjInit();

          log("Comprobando acceso: " + JAR_URL);
          const head = await fetch(JAR_URL, { method: "HEAD" });
          if (!head.ok)
            throw new Error(
              "No se puede acceder a " + JAR_URL + " (HTTP " + head.status + ")"
            );

          log("Ejecutando el JAR (Main-Class del MANIFEST) ‚Ä¶");
          await cheerpjRunJar(JAR_URL);

          log("Lanzado. Si es Swing, deber√≠a abrirse la ventana.");
        } catch (e) {
          console.error(e);
          log("‚ùå ERROR: " + (e.message || e));
        }
      }

      if (runBtn) runBtn.addEventListener("click", run);
      run(); // ejecuta autom√°ticamente
    </script>
  </body>
</html>
