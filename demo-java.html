<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Demo Java — CheerpJ</title>
  <style>
    :root {
      --bg: #0b0f19;
      --card: #141a2a;
      --text: #e6e9f0;
      --muted: #9aa3b2;
    }
    html, body {height:100%;margin:0}
    body {
      display:grid;place-items:center;
      background:var(--bg);color:var(--text);
      font-family:Inter,system-ui,sans-serif;
    }
    .card {
      width:min(960px,100%);height:min(640px,84vh);
      background:var(--card);border:1px solid rgba(255,255,255,.08);
      border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.35);
      display:flex;flex-direction:column;overflow:hidden;
    }
    header {
      padding:10px 14px;border-bottom:1px solid rgba(255,255,255,.08);
      display:flex;gap:16px;align-items:center;justify-content:flex-end;
    }
    #status {
      padding:8px 12px;border-top:1px solid rgba(255,255,255,.08);
      font-size:14px;color:var(--muted);white-space:pre-wrap;
    }
    a {color:#a5b4fc;text-decoration:none}
    button {
      padding:8px 12px;border-radius:10px;background:#1e2638;
      color:#fff;border:1px solid rgba(255,255,255,.1);cursor:pointer;
    }
  </style>
</head>

<body>
  <div class="card">
    <header>
      <a href="index.html">⟵ Volver</a>
      <a href="apps/Ajedrez.jar" download>Descargar JAR</a>
      <button id="retry">Reintentar</button>
    </header>
    <div id="status">Preparando entorno…</div>
  </div>

  <!-- Carga del runtime -->
  <script src="https://cjrtnc.leaningtech.com/3.0/loader.js"></script>
  <script>
    const statusEl = document.getElementById("status");
    function log(m){statusEl.textContent=m;console.log("[DEMO]",m)}

    async function runDemo() {
      try {
        log("Inicializando CheerpJ...");
        await cheerpjInit({canvas: null}); // asegura la inicialización completa

        log("Añadiendo classpath...");
        await cheerpjAddClasspath("apps/Ajedrez.jar");

        log("Ejecutando ajedrez.Ajedrez.main()...");
        await cheerpjRunMain("ajedrez.Ajedrez", []);

        log("Main ejecutado correctamente. Si es Swing, debería abrir ventana.");
      } catch (err) {
        console.error(err);
        log("❌ ERROR: " + (err.message || err));
      }
    }

    document.getElementById("retry").addEventListener("click", runDemo);
    // esperar a que el runtime esté listo antes de llamar
    window.addEventListener("load", runDemo);
  </script>
</body>
</html>
